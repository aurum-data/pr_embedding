services:
  - type: web
    name: pr-embedding
    env: python
    pythonVersion: 3.11.7
    plan: starter
    region: oregon
    buildCommand: export CARGO_HOME=/opt/render/project/.cargo && mkdir -p "$CARGO_HOME" && pip install --upgrade pip && pip install -r requirements.txt
    startCommand: uvicorn app.main:app --host 0.0.0.0 --port $PORT
    envVars:
      - key: MODEL_REPO_ID
        value: nomic-ai/nomic-embed-text-v1.5-GGUF
      - key: MODEL_FILE
        value: nomic-embed-text-v1.5.Q4_K_M.gguf
      - key: MODEL_CACHE_DIR
        value: /opt/render/project/.models
      - key: THREADS
        value: "4"
      - key: CARGO_HOME
        value: /opt/render/project/.cargo
